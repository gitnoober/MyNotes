{"ast":null,"code":"import _objectSpread from\"/home/ps/Documents/notestest/notesfrontendtest/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"/home/ps/Documents/notestest/notesfrontendtest/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/ps/Documents/notestest/notesfrontendtest/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/home/ps/Documents/notestest/notesfrontendtest/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState,useEffect,useContext}from'react';import AuthContext from'../context/AuthContext';import{ReactComponent as ArrowLeft}from'../assets/arrow-left.svg';import{Link}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var NotePage=function NotePage(_ref){var match=_ref.match,history=_ref.history;var _useContext=useContext(AuthContext),authTokens=_useContext.authTokens;var noteIdd=match.params.id;var _useState=useState(noteIdd),_useState2=_slicedToArray(_useState,2),noteId=_useState2[0],setNoteId=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),note=_useState4[0],setNote=_useState4[1];var getNote=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!(noteId==='new')){_context.next=6;break;}_context.next=3;return fetch('/api/notes/new/',{method:'POST',headers:{'Content-Type':'application/json','Authorization':'Bearer '+String(authTokens.access)}});case 3:response=_context.sent;_context.next=9;break;case 6:_context.next=8;return fetch(\"/api/notes/\".concat(noteId,\"/\"),{headers:{'Content-Type':'application/json','Authorization':'Bearer '+String(authTokens.access)}});case 8:response=_context.sent;case 9:_context.next=11;return response.json();case 11:data=_context.sent;setNote(data);if(noteId==='new'){setNoteId(data.id);}console.log(\"get note function invoked\",note);case 15:case\"end\":return _context.stop();}}},_callee);}));return function getNote(){return _ref2.apply(this,arguments);};}();var updateNote=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:fetch(\"/api/notes/\".concat(noteId,\"/update/\"),{method:'PUT',headers:{'Content-Type':'application/json','Authorization':'Bearer '+String(authTokens.access)},body:JSON.stringify(note)});case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function updateNote(){return _ref3.apply(this,arguments);};}();useEffect(function(){getNote();},[noteId]);var deleteNote=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:fetch(\"/api/notes/\".concat(noteId,\"/delete/\"),{method:'DELETE',headers:{'Content-Type':'application/json','Authorization':'Bearer '+String(authTokens.access)}});history.push('/');case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function deleteNote(){return _ref4.apply(this,arguments);};}();var handleSubmit=function handleSubmit(){if(!note.body){deleteNote();}else{updateNote();}history.push('/');};var handleChange=function handleChange(value){setNote(function(note){return _objectSpread(_objectSpread({},note),{},{'body':value});});console.log('Handle change:',note);};if(!note){return/*#__PURE__*/_jsx(\"div\",{});}else{return/*#__PURE__*/_jsxs(\"div\",{className:\"note\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"note-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:/*#__PURE__*/_jsx(ArrowLeft,{onClick:handleSubmit})}),/*#__PURE__*/_jsx(\"button\",{onClick:deleteNote,children:\"Delete\"})]}),/*#__PURE__*/_jsx(\"textarea\",{onChange:function onChange(e){handleChange(e.target.value);},value:note===null||note===void 0?void 0:note.body})]});}};export default NotePage;","map":{"version":3,"sources":["/home/ps/Documents/notestest/notesfrontendtest/src/pages/NotePage.js"],"names":["React","useState","useEffect","useContext","AuthContext","ReactComponent","ArrowLeft","Link","NotePage","match","history","authTokens","noteIdd","params","id","noteId","setNoteId","note","setNote","getNote","fetch","method","headers","String","access","response","json","data","console","log","updateNote","body","JSON","stringify","deleteNote","push","handleSubmit","handleChange","value","e","target"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport AuthContext from '../context/AuthContext';\nimport { ReactComponent as ArrowLeft } from '../assets/arrow-left.svg'\nimport { Link } from 'react-router-dom';\n\n\nconst NotePage = ({ match, history }) => {\n    \n    let {authTokens} = useContext(AuthContext)\n    let noteIdd = match.params.id\n    let [noteId, setNoteId] = useState(noteIdd)\n    let [note, setNote] = useState(null)\n\n    let getNote = async ()=> {\n        if (noteId === 'new'){\n            var response = await fetch('/api/notes/new/', {\n                method : 'POST',\n                headers : {\n                    'Content-Type' : 'application/json',\n                    'Authorization' : 'Bearer ' + String(authTokens.access)\n                }\n            })\n        }\n        else {\n            var response = await fetch(`/api/notes/${noteId}/`, {\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Authorization' : 'Bearer ' + String(authTokens.access)\n\n                }\n            })\n        }\n        let data = await response.json()\n        setNote(data)\n        if (noteId === 'new'){\n            setNoteId(data.id)\n        }\n        console.log(\"get note function invoked\", note)\n    }\n    \n\n    let updateNote = async ()=> {\n        fetch(`/api/notes/${noteId}/update/`,{\n            method : 'PUT',\n            headers: {\n                'Content-Type' : 'application/json',\n                'Authorization' : 'Bearer ' + String(authTokens.access)\n            },\n            body:JSON.stringify(note)\n        })\n    }\n\n    useEffect(()=>{\n        getNote()\n    }, [noteId])\n\n    let deleteNote = async ()=>{\n        fetch(`/api/notes/${noteId}/delete/`,{\n            method:'DELETE',\n            headers:{\n                'Content-Type' : 'application/json',\n                'Authorization' : 'Bearer ' + String(authTokens.access)\n            }\n        })\n        history.push('/')\n    }\n\n\n    let handleSubmit = ()=>{\n        if (!note.body){\n            deleteNote()\n        } else {\n            updateNote()    \n        }\n        history.push('/')\n    }\n\n    let handleChange = (value) => {\n        setNote(note => ({ ...note, 'body': value}))\n        console.log('Handle change:', note)\n    }\n\n\n    if(!note){\n        return <div>\n        </div>\n    }\n    else{\n        return(\n            <div className='note'>\n                <div className='note-header'>\n                    <h3>\n                        <ArrowLeft onClick={handleSubmit} />\n                    </h3>\n                    \n                    <button onClick={deleteNote}>Delete</button>\n                </div>\n                <textarea onChange={(e) => { handleChange(e.target.value) }} value={note?.body}></textarea>\n            </div>\n        )\n    }\n    \n};\n\nexport default NotePage;\n"]},"metadata":{},"sourceType":"module"}